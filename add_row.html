<!DOCTYPE html>
<html>
<head>
    <title>Add New Row</title>
    <style>
        #formContainer {
            margin-top: 20px;
        }
        .form-field {
            display: block;
            margin-bottom: 10px;
            padding: 8px;
            width: 50%;
        }
        button {
            padding: 10px 20px;
        }
    </style>
</head>
<body>

<h1>Add New Row</h1>

<div id="formContainer">
    <!-- Form fields will be dynamically inserted here -->
</div>

<button id="addButton">Add Row</button>

<script>
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbx05czIGcHH86lBhI0wybjz08h7-cbUWFcvgxawKIMw9m6CZNAT_3n1lsLG5v_ykiSV/exec';

    // Assuming you have the column headers or fetch them dynamically if possible
    const headers = ['Column1', 'Column2', 'Column3']; // Replace with your actual headers

    function createFormFields(headers) {
        const formContainer = document.getElementById('formContainer');

        headers.forEach(header => {
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = `Enter ${header}`;
            input.className = 'form-field';
            input.id = header;
            formContainer.appendChild(input);
        });
    }

    async function addNewRow() {
        const values = headers.map(header => {
            return document.getElementById(header).value.trim(); // Collect values, trimming whitespace
        });

        // Ensure no empty row is added if inputs are blank
        if (values.some(value => value === "")) {
            alert('Please fill in all fields.');
            return;
        }

        // Send data to Google Apps Script
        try {
            await fetch(webAppUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                mode: 'no-cors',
                body: JSON.stringify({ action: 'add', values: values })
            });
            alert('Row added successfully.');
            document.querySelectorAll('.form-field').forEach(field => field.value = ''); // Clear inputs
        } catch (error) {
            console.error('Error adding row:', error);
            alert('Failed to add row. Please try again.');
        }
    }

    document.getElementById('addButton').addEventListener('click', addNewRow);

    createFormFields(headers);
</script>

</body>
</html>
